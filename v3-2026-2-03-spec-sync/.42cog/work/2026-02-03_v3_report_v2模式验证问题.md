---
name: v2-pattern-validation-issues
description: V2 迁移模式的数据采集和分析可行性问题记录
date: 2026-02-03
---

# V2 → V3 模式可行性问题清单

> 在复查 v2 的 42 个模式和采集文档后，发现了 3 个关键问题，导致大量 v2 模式在 v3 中不可用或无意义

---

## 问题 1：时间精度不足

### 问题描述

v2 假设收集的数据包含秒级精度的时间戳（用于小时级分析），但 yt-dlp 实际仅提供日期级的 `published_at`。

### 受影响的模式

- **❌ 模式 15：最佳发布时段分析**
  * 原方法：`HOUR(FROM_UNIXTIME(timestamp))`
  * 实际限制：无法获取小时信息
  * 修正：改为日级分析（周末 vs 工作日）

### 数据收集限制

```
可用粒度：
✅ 日期级 (YYYY-MM-DD) - from published_at
✅ 星期级 (DAYOFWEEK) - 推导自 published_at
✅ 月级 (MONTH) - 推导自 published_at
❌ 小时级 (HOUR) - 无法获取
❌ 秒级 (SECOND) - 无法获取
```

### 根本原因

YouTube API (videos.list) 不提供发布时间的秒级信息，yt-dlp 提取的是 YouTube 网页展示的日期。要获取小时级数据需要：
- 频道管理员权限（YouTube Analytics）
- 或网页爬虫（速度慢且易被封）

---

## 问题 2：时长分档不符合 YouTube 原生逻辑

### 问题描述

v2 使用的自定义时长分档（<1min, 1-3min, 3-10min, 10-30min, 30+min）是**事后聚合**（post-hoc bucketing），不对应 YouTube 搜索的原生过滤器。这使得这些分档的分析**无法指导实际采集策略**。

### v2 的自定义分档（问题所在）

```
❌ <1分钟（短）
❌ 1-3分钟（短中）
❌ 3-10分钟（中）
❌ 10-30分钟（中长）
❌ 30分+（长）
```

**为什么无意义**：这些边界值是任意选择的，对应不了 YouTube 的任何实际约束或搜索过滤器。

### YouTube 原生时长分类

YouTube 搜索 API 支持的原生分类：
```
✅ short: < 4分钟
✅ medium: 4-20分钟
✅ long: > 20分钟
```

### 受影响的模式

- **模式 2-4：变量分布分析（时长相关部分）**
  * 原方法：使用 v2 的自定义分档
  * 问题：分档边界无意义，对比结果也就无意义
  * 修正：
    - 方案 A：使用 YouTube 原生分类
    - 方案 B：使用数据驱动的 P-分位数分桶
    - 方案 C：保留原始分布，不做分档

### 数据驱动的替代方案

**方案 1：P-分位数分桶**（推荐）
```
- P25: 最短 25%
- P25-P50: 较短 25%
- P50-P75: 较长 25%
- P75+: 最长 25%
```
优点：自动计算，每组样本量相等，对比有意义

**方案 2：YouTube 原生分类**
```
- short: < 4分钟
- medium: 4-20分钟
- long: > 20分钟
```
优点：对应实际搜索过滤，有业务含义

**方案 3：保留原始分布**
```
直接展示直方图、均值、中位数、标准差
不做人为分档
```
优点：最透明，不失信息

---

## 问题 3：任意分档分析缺乏业务含义

### 问题描述

v2 中大量分档都是任意数字，没有对应的真实约束或业务含义。这种分析会产生**虚假的模式识别**。

### 典型案例

**标题长度分档**

```sql
❌ CASE
    WHEN CHAR_LENGTH(title) >= 50 THEN '超长(50+字)'
    WHEN CHAR_LENGTH(title) >= 30 THEN '长(30-50字)'
    WHEN CHAR_LENGTH(title) >= 15 THEN '中(15-30字)'
    ELSE '短(<15字)'
END
```

**问题分析**：
- 为什么选 15、30、50？**没有原因**，这些都是任意数字
- YouTube 搜索结果显示：PC 端 ~60 字符，手机端 ~45 字符
- 但这只是 UI 限制，不影响推荐算法
- 不同话题的最优标题长度完全不同（教程 vs 段子 vs 新闻）
- **结论**：用固定分档对比无法得出任何有用的结论

### 受影响的分析

所有使用任意数值分档的分析，包括但不限于：
- ❌ 标题长度：15、30、50 字符
- ❌ 播放量：1k、10k、100k、1M
- ❌ 时长：1、3、10、30 分钟
- ❌ 任何标签为 "短/中/长" "低/中/高" "超长/适中" 等相对概念的分档

### 正确做法

**原则：分档必须基于真实约束或业务含义**

✅ **基于 YouTube 原生概念**
- 使用 YouTube 搜索本身支持的分类
- 参考（但不作为分析依据）YouTube UI 的显示限制

✅ **基于数据分布**
- P-分位数：自动计算，样本均匀分布
- 实际分布：展示直方图 + 统计量，不做分档

✅ **基于业务含义**
- 按内容类型分析：教程、段子、评测各自计算最优特征
- 按目标受众分析：不同受众群体
- 按发布者类型分析：新手 vs 百万粉丝频道

✅ **保留原始数据**
- 展示完整数据点，不聚合
- 标注样本量、置信区间、收集时间

### 检查清单

发布任何分析前，必须能回答这些问题：

- [ ] **"为什么选这个分档边界？"**
  - ✅ 有效答案：YouTube 原生分类 / 数据的中位数 / 行业标准
  - ❌ 无效答案：习惯上这样分 / 这个数字看起来不错

- [ ] **"不同话题混合了吗？"**
  - ✅ 分别分析教程、段子、评测等不同内容类型
  - ❌ 混合分析所有内容

- [ ] **"样本量多少？"**
  - ✅ 标注样本数量（如 "基于 250 条视频"）
  - ❌ 只说"短视频效果更好"，没有样本量

- [ ] **"数据分布是什么？"**
  - ✅ 展示直方图 + 均值 + 中位数
  - ❌ 只展示分档后的聚合数字

---

## 影响范围统计

### V2 的 42 个模式中

| 状态 | 数量 | 模式编号 | 处理方案 |
|------|------|--------|--------|
| ✅ 完全可用 | ~12 | 1, 6-12, 14, 16-26+ | 直接继承 |
| ⚠️ 需要调整 | ~15 | 2-5, 13 | 重新定义分档或粒度 |
| ❌ 不可用 | ~15 | 15 + 其他小时级分析 | 删除或改为日级分析 |
| 🤔 待逐一审视 | 未知 | 需要查看完整方法 | 逐个检查是否有任意分档 |

### 需要更新的文档

1. ✅ `real.md` - 已更新，添加了 3 个关键限制的详细说明
2. ⚠️ `cog.md` - 待更新，需添加模式有效性标注
3. ⚠️ `模式洞察-*.md` - 需逐一审视，标注可用状态
4. ⚠️ 分析脚本 - 需移除依赖小时级数据的查询

---

## 建议行动

### 立即进行（本周）

- [ ] 在 `real.md` Appendix B 中标注这 3 个问题（已完成）
- [ ] 添加 "分析质量守则" 章节防止重复 v2 的错误（已完成）
- [ ] 建立模式有效性评估表（见上表）

### 本月进行

- [ ] 逐个审视 42 个模式，标注可用状态
- [ ] 重新定义所有分档（删除任意边界值，改用 P-分位数或原生分类）
- [ ] 更新 cog.md 中的 PatternAnalysis 实体定义
- [ ] 检查所有分析脚本，移除不可用的查询

### 后续维护

- [ ] 任何新增分析都必须通过质量检查清单
- [ ] 定期审视已有模式是否引入了新的任意分档

---

## 关键洞察

> **核心教训**：V2 的许多模式是在数据能力和 YouTube 原生逻辑的认知不足的情况下设计的。V3 必须坚持两个原则：

1. **诚实面对数据能力的边界**
   - 能收集什么就分析什么
   - 不能收集的不要假装能分析
   - 透明标注每个数据的精度和来源

2. **分析必须有意义**
   - 分档必须基于真实约束（YouTube 原生 / 数据分布 / 业务含义）
   - 不用任意数字来隐喻概念
   - 保留原始数据，让用户可以验证

这两条原则会让 V3 的分析虽然比 V2 简化，但**更可信、更可执行**。
