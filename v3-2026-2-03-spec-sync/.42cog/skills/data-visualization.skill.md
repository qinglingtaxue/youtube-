---
name: data-visualization
description: 数据可视化技能 - 选择合适的图表类型展示数据
version: 1.0
created: 2026-02-04
updated: 2026-02-04
triggers:
  - "设计图表"
  - "数据可视化"
  - "选择图表"
  - "画图表"
  - "展示数据"
---

# 数据可视化技能

> **触发条件**：当需要为页面选择数据可视化方式时使用
>
> **核心原则**：确保图的多样性和直观性，根据数据类型和数量级选择最合适的可视化方式
>
> **认知映射**：复杂概念（如中心性）必须用图表直观化，而非用数字展示

---

## 设计前必读

在选择图表类型之前，必须阅读：

1. **CHART_SELECTION_GUIDE.md** - 图表选择决策指南
2. **real.md Appendix C** - 用户认知边界
3. **cog.md 用户认知模型** - 用户能理解/不能理解的概念

---

## 图表选择流程

### 步骤 1：回答决策问题

在选择图表前，必须明确：

```
1. 数据类型是什么？（分类/数值/时间/关系/地理）
2. 数据量级是多少？（<10 / 10-100 / 100-1000 / 1000+）
3. 用户需要回答什么问题？（对比/趋势/分布/关系/占比/流向）
4. 用户的认知水平如何？（能直接理解 / 需要图表辅助理解）
5. 这个页面已有哪些类型的图表？（确保多样性）
6. 是否需要与其他图表联动？
```

### 步骤 2：查询决策矩阵

---

## 1. 决策矩阵：数据类型 × 目的 × 图表类型

### 1.1 单变量分析（一维数据）

| 数据特征 | 数量级 | 推荐图表 | 备选方案 | 不推荐 |
|---------|-------|---------|---------|-------|
| **分类计数** (如：时长分档) | 2-5 类 | 环形图 Doughnut | 饼图、柱状图 | 表格 |
| **分类计数** | 6-10 类 | 水平柱状图 | 树图 Treemap | 饼图（太多扇区） |
| **分类计数** | 10+ 类 | 树图 Treemap | 词云 | 饼图、柱状图 |
| **连续分布** (如：播放量分布) | 任意 | 直方图 Histogram | 箱线图 | 饼图 |
| **排名数据** (如：Top10) | ≤10 | 水平柱状图 | 数字卡片+表格 | 饼图 |
| **排名数据** | 10-50 | 表格+迷你条 | 气泡图 | 柱状图（太挤） |
| **单一指标** (如：总播放量) | 1 个 | 数字卡片 | 仪表盘 Gauge | 图表 |
| **多个关键指标** | 3-6 个 | 卡片行 | 雷达图 | 表格 |

### 1.2 双变量分析（二维数据）

| 数据关系 | 数量级 | 推荐图表 | 备选方案 | 不推荐 |
|---------|-------|---------|---------|-------|
| **时间趋势** (如：月度发布量) | ≤12 点 | 折线图（带面积） | 柱状图 | 散点图 |
| **时间趋势** | 12-50 点 | 折线图（无面积） | 面积图 | 柱状图 |
| **时间趋势** | 50+ 点 | 折线图（采样）| 热力图 | 逐点显示 |
| **两指标相关** (如：播放×点赞) | ≤50 点 | 散点图 | 气泡图 | 双柱状图 |
| **两指标相关** | 50-500 点 | 散点图+密度 | 六边形分箱 | 逐点标注 |
| **两指标相关** | 500+ 点 | 热力散点图 | 等高线图 | 普通散点 |
| **部分与整体** (如：Top10占比) | 2-5 部分 | 堆叠柱状图 | 饼图 | 多个独立柱 |
| **部分与整体** | 5+ 部分 | 百分比堆叠柱 | 瀑布图 | 饼图 |
| **两时间序列对比** | 任意 | 双轴折线图 | 面积叠加 | 独立两图 |

### 1.3 多变量分析（三维及以上）

| 数据关系 | 数量级 | 推荐图表 | 备选方案 | 不推荐 |
|---------|-------|---------|---------|-------|
| **多指标对比** (如：频道多维评估) | 3-7 指标 | 雷达图 | 平行坐标 | 多柱状图 |
| **多指标对比** | 7+ 指标 | 热力矩阵 | 平行坐标 | 雷达图（太密） |
| **层级结构** (如：分类→子分类) | 2-3 层 | 树图 Treemap | 旭日图 Sunburst | 多饼图 |
| **层级结构** | 3+ 层 | 旭日图 | 层级树 | 树图 |
| **流量流向** (如：来源→视频→行为) | 任意 | 桑基图 Sankey | 弦图 Chord | 多柱状图 |
| **网络关系** (如：视频关联) | ≤50 节点 | 力导向图 | 弧线图 | 矩阵图 |
| **网络关系** | 50-200 节点 | 力导向图+聚类 | 邻接矩阵 | 逐点标注 |
| **网络关系** | 200+ 节点 | 聚合网络图 | 矩阵热力图 | 完整网络 |
| **时间×分类** (如：发布时间热力) | 小时×星期 | 热力图 | 日历图 | 折线图 |
| **地理分布** | 任意 | 地图+标记 | 气泡地图 | 表格 |
| **关键词/标签** | 20-200 词 | 词云 | 树图 | 列表 |

---

## 2. 数据量级决策树

```
数据点数量?
├── 1-5 个
│   ├── 是关键指标? → 数字卡片
│   └── 是分类占比? → 环形图/饼图
│
├── 6-20 个
│   ├── 是排名? → 水平柱状图
│   ├── 是时间序列? → 折线图
│   ├── 是分类统计? → 垂直柱状图
│   └── 是关键词? → 词云（小型）
│
├── 20-100 个
│   ├── 是时间序列? → 折线图（降采样）
│   ├── 是二维相关? → 散点图
│   ├── 是分类统计? → 树图 Treemap
│   ├── 是网络关系? → 力导向图
│   └── 是关键词/标签? → 词云
│
├── 100-1000 个
│   ├── 是分布数据? → 直方图 + 箱线图
│   ├── 是二维相关? → 散点图 + 趋势线
│   ├── 是网络关系? → 聚类网络图
│   └── 是文本数据? → 词云
│
└── 1000+ 个
    ├── 是分布数据? → 核密度估计图
    ├── 是二维相关? → 六边形分箱 / 热力散点
    └── 是网络关系? → 聚合矩阵
```

---

## 3. 用户认知映射：图表帮助理解抽象概念

### 3.1 核心映射表

| 用户不理解的概念 | 可视化方式 | 图表类型 | 说明 |
|----------------|-----------|---------|------|
| **中介中心性** (Betweenness) | 节点大小 / 连线数量 | 网络图 | 节点越大 = 越是信息桥梁 |
| **程度中心性** (Degree) | 节点连线数 / 节点颜色 | 网络图 | 连线越多 = 传播越广 |
| **有趣度** (Interestingness) | 金色高亮 + 节点大小 | 网络图 | 金色 = 套利机会 |
| **P分位数** | 标注线 + 区域 | 直方图 | 在分布图上标注分位线 |
| **置信度** | 误差棒 | 柱状图/折线图 | 误差范围表示不确定性 |
| **互动率** | 播放量vs点赞散点 | 散点图 | 用两个用户懂的指标展示 |
| **流量来源** | 流向宽度 | 桑基图 | 越宽 = 流量越大 |
| **内容相似度** | 节点距离 | 网络图 | 越近 = 越相似 |
| **时间分布** | 颜色深浅 | 热力图 | 越深 = 越集中 |
| **关键词重要性** | 字体大小 | 词云 | 越大 = 越重要 |

### 3.2 网络图是理解中心性的最佳工具

> **用户反馈**：信息网络图可以帮助直观的理解中介中心性、程度中心性、有趣度

**网络图展示套利分析的方式**：

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   控制面板:                                                      │
│   ┌────────────────┐ ┌────────────────┐ ┌────────────────┐      │
│   │ 节点大小:      │ │ 节点颜色:      │ │ 显示节点:      │      │
│   │ [有趣度 ▼]     │ │ [有趣度 ▼]     │ │ [全部 ▼]       │      │
│   └────────────────┘ └────────────────┘ └────────────────┘      │
│                                                                 │
│   网络图区域:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                         │   │
│   │      ●───────●                     节点大小 = 指标值     │   │
│   │     /│       │\                    金色 = 高有趣度      │   │
│   │    ● │   ◉   │ ●                   紫色 = 高中介        │   │
│   │     \│  (大) │/                    红色 = 高程度        │   │
│   │      ●───────●                                          │   │
│   │                                                         │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   图例:                                                          │
│   [●金] 高有趣度 [●紫] 高中介 [●红] 高程度 [●灰] 低中心性       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.3 词云展示关键词/标签重要性

> **使用场景**：标签分析、关键词分布、话题热度

**词云适用条件**：
- 数据量：20-200 个词/标签
- 目的：快速识别高频/重要关键词
- 用户认知：直观理解大 = 重要

```
┌─────────────────────────────────────────────────┐
│                                                 │
│        养生        健康         食疗            │
│    中医              运动                       │
│          保健    减肥       睡眠                │
│      膝盖    颈椎    按摩                       │
│          血压  糖尿病    补肾                   │
│                                                 │
│  字体越大 = 出现频率越高 / 重要性越高           │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 4. 图表类型速查表

### 4.1 可用图表库（16 种）

| 类别 | 图表类型 | 函数名 | 依赖 | 适用场景 |
|------|---------|--------|------|---------|
| **基础** | 柱状图 | `createBarChart` | Chart.js | 分类对比 |
| **基础** | 水平柱状图 | `createHorizontalBarChart` | Chart.js | 排名展示 |
| **基础** | 饼图 | `createPieChart` | Chart.js | 占比（2-5类） |
| **基础** | 环形图 | `createDoughnutChart` | Chart.js | 分层展示 |
| **基础** | 折线图 | `createLineChart` | Chart.js | 时间趋势 |
| **基础** | 双轴折线图 | `createDualAxisLineChart` | Chart.js | 增长趋势 |
| **基础** | 雷达图 | `createRadarChart` | Chart.js | 多维对比 |
| **基础** | 散点图 | `createScatterChart` | Chart.js | 相关性分析 |
| **基础** | 直方图 | `createHistogram` | Chart.js | 分布展示 |
| **高级** | 网络图 | `createNetworkGraph` | vis-network | 信息网络 |
| **高级** | 有趣度网络 | `createInterestingnessNetwork` | vis-network | 套利分析 |
| **高级** | 地图 | `createMap` | Leaflet | 地理分布 |
| **高级** | 热力图 | `createHeatmap` | ECharts | 时间/频率 |
| **高级** | 树图 | `createTreemap` | ECharts | 层级占比 |
| **高级** | 桑基图 | `createSankeyDiagram` | ECharts | 流量流向 |
| **高级** | 词云 | `createWordCloud` | ECharts | 关键词分析 |

### 4.2 用户理解难度

| 图表类型 | 用户理解难度 | 适用场景 | 注意事项 |
|---------|-------------|---------|---------|
| 柱状图 | ⭐ 极易 | 分类对比、排名 | 不超过 15 个柱 |
| 折线图 | ⭐ 极易 | 时间趋势 | 不超过 3 条线 |
| 饼图/环形图 | ⭐ 极易 | 占比（2-5类） | 避免 3D 饼图 |
| 数字卡片 | ⭐ 极易 | 关键指标 | 不超过 6 个 |
| 表格 | ⭐⭐ 易 | 详细数据 | 需排序功能 |
| 散点图 | ⭐⭐ 易 | 相关性 | 需解释轴含义 |
| 词云 | ⭐⭐ 易 | 关键词分布 | 需说明大小含义 |
| 热力图 | ⭐⭐⭐ 中 | 时间×分类 | 需颜色图例 |
| 雷达图 | ⭐⭐⭐ 中 | 多维对比 | 指标不超过 7 |
| 树图 | ⭐⭐⭐ 中 | 层级占比 | 需清晰分组 |
| 网络图 | ⭐⭐⭐⭐ 难 | 关系网络 | 需图例+交互 |
| 桑基图 | ⭐⭐⭐⭐ 难 | 流量流向 | 需详细说明 |
| 弦图 | ⭐⭐⭐⭐⭐ 很难 | 双向关系 | 仅专业用户 |

---

## 5. 多样性保证检查清单

每个页面应至少包含以下类型的图表，确保视觉多样性：

```
□ 数字展示类（卡片/仪表盘）    - 快速扫描
□ 比例类（饼图/环形图/树图）   - 占比理解
□ 比较类（柱状图）             - 大小对比
□ 趋势类（折线图/面积图）      - 时间变化
□ 关系类（散点图/网络图）      - 相关发现
□ 分布类（直方图/热力图）      - 数据分布
□ 文本类（表格/列表/词云）     - 详细信息
```

### 页面多样性检查示例

**全局认识页面**：
- ✅ 数字展示：数字卡片行
- ✅ 比例类：环形图（时长、频道规模）
- ✅ 比较类：柱状图（播放量分层、时间窗口）
- ✅ 趋势类：折线图（视频趋势）
- ✅ 关系类：散点图（四象限）
- ✅ 分布类：直方图（播放量分布）、热力图（发布时间）
- ✅ 文本类：表格（Top10频道）

**套利分析页面**：
- ✅ 数字展示：公式卡片、榜单
- ✅ 关系类：网络图（核心）、散点图
- ✅ 文本类：列表
- ⚠️ 可添加：词云（关键词分析）、中心性分布直方图

---

## 6. 颜色方案

### 6.1 主色板

```css
--primary: #667eea;      /* 主色：蓝紫 */
--secondary: #764ba2;    /* 辅色：紫 */
--accent: #f5576c;       /* 强调：红 */
--warning: #ffd700;      /* 警示/有趣度：金 */
--success: #00f2fe;      /* 成功：青 */
--info: #4facfe;         /* 信息：蓝 */
```

### 6.2 语义化颜色

| 场景 | 颜色 | 用途 |
|------|------|------|
| 高价值/套利机会 | 金色 #ffd700 | 有趣度榜单、高亮节点 |
| 热门/高传播 | 红色 #f5576c | 程度中心性、爆款 |
| 价值/桥梁 | 蓝紫 #667eea | 中介中心性 |
| 普通/中等 | 浅蓝 #4facfe | 中等数据 |
| 冷门/低值 | 灰蓝 #a8b4ff | 低中心性 |

### 6.3 渐变序列（用于热力图/分布）

```css
/* 冷→热渐变 */
--gradient-cool-warm: #f5f7fa → #667eea → #764ba2 → #f5576c;

/* 单色渐变（用于柱状图） */
--gradient-primary: #e0e5ff → #667eea;
```

---

## 7. 交互设计原则

| 交互类型 | 适用图表 | 实现方式 |
|---------|---------|---------|
| 悬停高亮 | 所有图表 | 显示 tooltip，高亮当前元素 |
| 点击详情 | 散点图、网络图 | 弹出详情面板或跳转 |
| 筛选联动 | 多图表页面 | 全局筛选器，图表同步更新 |
| 缩放平移 | 网络图、地图 | 滚轮缩放，拖拽平移 |
| 切换视图 | 榜单、网络图 | 指标切换器（有趣度/中介/程度） |
| 时间范围 | 趋势图 | 时间窗口选择器 |

---

## 8. 禁止做的事 ❌

### 图表选择
- ❌ 饼图超过 5 个扇区（用树图或柱状图）
- ❌ 柱状图超过 15 个柱（用水平柱或树图）
- ❌ 雷达图超过 7 个维度（用热力矩阵）
- ❌ 网络图超过 200 个节点不聚合（用聚合网络）

### 颜色使用
- ❌ 用红绿色表示对比（色盲不友好）
- ❌ 用超过 7 种颜色区分类别
- ❌ 热力图不提供颜色图例

### 交互设计
- ❌ 图表不提供 tooltip
- ❌ 网络图不支持缩放平移
- ❌ 多图表页面不支持联动筛选

### 用户认知
- ❌ 用数字展示用户不理解的概念（如中心性=0.85）
- ❌ 不解释专业术语
- ❌ 不提供图表说明/图例

---

## 9. 用户反馈记录

以下是历史用户反馈，设计时应避免重复这些错误：

| 反馈 | 问题 | 正确做法 |
|------|------|---------|
| "还有信息网络图、地图" | 遗漏高级图表类型 | 检查是否需要网络图/地图/热力图/桑基图/词云 |
| "还有桑基图" | 遗漏流量流向图表 | 流量归因场景使用桑基图 |
| "信息网络图可以帮助直观理解中介中心性、程度中心性、有趣度" | 抽象概念用数字展示 | 用图表（特别是网络图）直观化抽象概念 |
| "什么数量级用什么图，什么数据类型用什么图" | 缺少选择决策 | 先判断数据类型和量级再选图表 |
| "要确保图的多样性和直观性" | 图表类型单一 | 每页检查多样性清单 |
| "你没提到词云" | 遗漏词云图表 | 关键词/标签场景使用词云 |

---

## 10. 模板文件位置

```
src/templates/charts/
├── chart-templates.js           # 16 种图表函数库
├── chart-styles.css             # 完整样式表
├── global-overview-template.html     # 全局认识页面模板
├── arbitrage-analysis-template.html  # 套利分析页面模板
└── CHART_SELECTION_GUIDE.md     # 图表选择决策指南（详细版）
```

---

## 相关文档

- `src/templates/charts/CHART_SELECTION_GUIDE.md` - 完整决策矩阵
- `ui-layout-design.skill.md` - UI 布局设计技能
- `real.md Appendix C` - UI/UX 设计约束
- `cog.md UserCognitionModel` - 用户认知模型
