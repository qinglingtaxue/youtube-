# Claude Code 项目配置

## 项目概述
本项目为 YouTube 最小化视频故事创建工具 (v3) - 专注于规范同步的版本。

## 个人环境信息

### 设备与硬件
- **操作系统**：macOS
- **处理器架构**：Apple 芯片 (ARM64)
- **设备类型**：Mac 电脑

### 开发工具链

#### Node.js 管理
- **包管理器**：bun
- **用途**：Node.js 版本管理和依赖安装
- **安装命令**：`bun install`
- **运行脚本**：`bun run <script>`

#### Python 环境
- **环境管理器**：uv
- **用途**：Python 版本和虚拟环境管理
- **安装命令**：`uv venv`
- **依赖管理**：`uv pip install` 或 `uv sync`

### 代码托管

#### Git 代码平台
- **平台名称**：cnb.cool
- **用途**：代码版本控制和协作
- **配置方式**：本地 git 配置指向该平台

## 沟通语言
- **所有沟通**：使用中文（简体中文）
- **代码注释**：根据项目规范，建议中英文混合
- **文档**：优先使用中文

## 项目路径
```
/Users/su/Downloads/3d_games/5-content-creation-tools/youtube-minimal-video-story/v3-2026-2-03-spec-sync
```

## 后续沟通约定
- 所有回复和指示均使用**中文**
- 提供技术建议时包含相关文件路径和行号
- 使用中文变量名时需要清晰标注
- 代码示例中注释采用中文

---

## UI/UX 设计规范

> **核心原则**：用户第一秒没看到想要的功能，就会划走不看了。
>
> **工作记忆约束**：人类工作记忆容量 4±1，超过 5 个并列选项必须分组

### 设计前必读

当用户要求设计页面布局或 UI 时，必须先阅读：
1. `.42cog/real/real.md` Appendix C - UI/UX 设计约束
2. `.42cog/cog/cog.md` 用户认知模型章节
3. `.42cog/skills/ui-layout-design.skill.md` - 完整设计检查清单

### 工作记忆约束（强制）

- Tab 数量 > 5 个 → **必须分组**
- 每组 Tab ≤ 4 个
- 组的数量 ≤ 3 个（+ 可选外链）
- 按用户决策流程分组：`看数据 → 找机会 → 去行动`

### 功能归属原则（强制）

- ❌ 数据展示和行动建议不能混在同一个 Tab
- ❌ 综合建议/行动指南不能放在数据分析页面
- ✅ "综合建议"放在独立的"信息报告"页
- ✅ 数据页用外链指向行动页

### 视觉层级（强制）

首屏内容优先级（从上到下）：
```
1. 用户核心操作入口（搜索框）     ← 第一眼
2. 用户历史状态（搜索记录）       ← 第二眼
3. 核心功能入口（≤3个）          ← 第三眼
4. 推荐内容/快速发现              ← 第四眼
5. 统计概览                       ← 放最底部
```

### 禁止事项

**视觉层级**：
- ❌ 把"数据概览"/"统计数字"放在首屏顶部
- ❌ 功能入口超过 3 个

**筛选设计**：
- ❌ 默认展开所有筛选条件（应默认折叠）
- ❌ 包含用户看不懂的筛选（如"互动率范围"）

**排序设计**：
- ❌ 使用"综合排序"、"热门"、"推荐"等模糊概念
- ❌ 隐藏排序方向选择

**分类分档**：
- ❌ 发明 YouTube 不支持的时长分档（必须用 <4min / 4-20min / >20min）
- ❌ 使用任意数值分档（如标题长度 15/30/50 字符）

### 排序设计（强制）

排序必须拆分为三个独立选择：
```
时间范围: [7天内 ▼]    排序字段: [播放量 ▼]    方向: [高→低 ▼]

当前: 7天内发布的视频，按播放量从高到低排序  ← 用自然语言显示
```

### 用户认知边界

**用户能理解** ✅：播放量、点赞数、评论数、订阅数、时长、发布时间

**用户不理解** ❌：互动率、效率分数、中心性、P分位数、置信度

### 有趣度公式 UI 展示（套利分析页面）

> 有趣度 = 中介中心性 ÷ 程度中心性 = 价值 ÷ 传播 = 套利机会

**三榜单必须独立展示**：
- 💎 有趣度榜（默认选中）
- 🌉 中介中心性榜
- 🔥 程度中心性榜

### 排序与榜单类型并排布局

```
┌─ 榜单类型（左侧）────────┬─ 排序控制（右侧）─────┐
│ ● 黑马视频 ← 默认       │ 时间: [7天内 ▼]      │
│ ○ 爆款视频              │ 字段: [播放量 ▼]     │
│ ○ 增长最快              │ 方向: [高→低 ▼]      │
│                         ├──────────────────────┤
│                         │ 7天内，按播放量高→低 │
│                         │     [▶ 展开筛选条件] │
└─────────────────────────┴──────────────────────┘
```

---

## 设计工作流程（强制）

### ⚠️ 核心原则
**讨论设计方案时，不要急着写代码。先画布局草稿，等全部确认了，再写代码和生成 HTML 文件。**

### 📝 三阶段工作流

#### 第 1 阶段：设计讨论（只写文档，不写代码）
- **产出**：ASCII 文本布局草稿、设计对比图、交互说明
- **记录位置**：`.42cog/work/` 中的 `design` 类型文件
- **文件名示例**：`2026-02-04_design_信息报告-结论布局草稿.md`
- **内容示例**：
  ```
  ┌─ 结论卡片 1 ────────────────┐
  │ ① 市场竞争分散              │
  │   摘要: Top 10 占 23%        │
  │   [▼ 展开数据]              │
  └──────────────────────────────┘

  ┌─ 结论卡片 2 ────────────────┐
  ...
  ```

#### 第 2 阶段：设计自我审查（在请求用户反馈前）
- **任务**：用检查清单逐项验证设计，确保没有违反约束
- **何时执行**：完成 design 文件后，发给用户前
- **目标**：减少用户反馈，力争一次过（✅ 0 反馈）
- **产出**：修改后的 design 文件（或新的 decision 文件）
- **记录位置**：在 design 文件中标注"✅ 自我审查通过"或"⚠️ 已调整"

**检查清单**：

**A. Tab 设计检查**（如果页面有 Tab）
- [ ] Tab 总数是否 ≤ 5 个？
- [ ] 如果 > 5，是否按决策流程分组（看数据 → 找机会 → 去行动）？
- [ ] 分组后每组是否 ≤ 4 个 Tab？
- [ ] 分组总数是否 ≤ 3 个（+ 可选外链）？
- [ ] Tab 名称是否清晰易懂，避免抽象（如避免"其他"、"更多"）？
- [ ] 数据展示和行动建议是否分开在不同 Tab？

**B. 视觉层级检查**
- [ ] 首屏第一眼是用户的核心操作入口吗？（如搜索框）
- [ ] 用户历史（搜索记录等）是否紧跟在操作入口后？
- [ ] 统计数据/概览是否放在了页面最底部？
- [ ] 核心功能入口是否控制在 3 个以内？
- [ ] 是否避免了无关的装饰元素占用首屏空间？

**C. 排序/筛选设计检查**（如果有）
- [ ] 排序是否拆分为三个独立选择：时间范围 + 排序字段 + 排序方向？
- [ ] 是否避免了"综合排序"、"热门"、"推荐"等模糊概念？
- [ ] 排序方向选择是否对用户可见（而非隐藏）？
- [ ] 是否用自然语言显示当前排序规则？（如"过去7天，按播放量高→低"）
- [ ] 筛选条件是否默认折叠（而非展开所有）？
- [ ] 筛选条件是否都能用自然语言解释？避免专业术语（如"互动率"、"中心性"）？

**D. 用户认知检查**
- [ ] 所有用户可选项用户都能理解吗？
- [ ] 是否避免了使用专业术语（互动率、效率分数、中心性、P分位数、置信度）？
- [ ] 复杂概念是否有括号解释？（如"效率分数（平均播放÷订阅）"）
- [ ] 是否避免了发明 YouTube 不支持的分类（时长必须用 <4min / 4-20min / >20min）？

**E. 页面职责检查**
- [ ] 页面是否只承担 ≤ 2 种用户任务？
- [ ] 数据展示和行动建议是否混杂？（不应该混杂）
- [ ] 是否有清晰的"出口"（导出/外链）指向其他页面？
- [ ] 是否避免了在一个页面中重复展示其他页面的数据？

**F. 状态管理检查**（如果有用户输入）
- [ ] 用户的搜索历史是否会被保存（localStorage）？
- [ ] 筛选条件是否会被保存（下次访问还能恢复）？
- [ ] 是否提供"清空历史"选项？
- [ ] 页面刷新后状态是否保持（不会重置）？

**G. 设计约束对标**
- [ ] 是否遵循 `real.md` Appendix C（UI/UX 通用约束）？
- [ ] 是否遵循 `real.md` Appendix D（信息报告特定约束，如适用）？
- [ ] 是否遵循 `real.md` Appendix E（创作者中心特定约束，如适用）？
- [ ] 是否存在其他需要补充的约束文档？（如果是新页面类型）

**如何使用**：
1. 完成 design 文件
2. 逐项检查上述清单
3. 对于"❌"的项，**立即调整设计**或**记录为已知问题并说明原因**
4. 在 design 文件顶部添加：`✅ 自我审查状态：全部通过` 或 `⚠️ 已调整（见第 X 项）`
5. 发给用户时附上简短说明："已完成自我审查，调整项：#A2, #B3"

#### 第 3 阶段：设计确认（用户反馈→修改方案）
- **任务**：根据用户反馈修改草稿（重复第 2 阶段）
- **重复直到**：✅ 用户明确说"可以"或"同意"
- **记录位置**：同一个 `design` 文件，或新建 `decision` 文件记录最终决策
- **期望**：如果第 2 阶段审查充分，此阶段反馈应该极少

#### 第 4 阶段：代码实现（仅在第 1、2、3 阶段全部✅后执行）
- **前提**：必须有用户的明确确认（✅ 同意这个布局）
- **产出**：HTML/CSS/JavaScript 代码
- **生成位置**：`src/templates/charts/` 或其他代码目录
- **记录位置**：`.42cog/work/` 中的 `guide` 类型文件（可选，记录实现细节）

### 📋 文件类型对应关系

| 设计阶段 | 文件类型 | 用途 | 示例 |
|---------|---------|------|------|
| 布局草稿 + 初步讨论 | `design` | 展示设计方案、自我审查、收集反馈 | `2026-02-04_design_信息报告-结论布局.md` |
| 设计确认 + 决策记录 | `decision` | 记录为什么选择这个方案、最终确认 | `2026-02-04_decision_信息报告-结论顺序调整.md` |
| 实现细节指南 | `guide` | 代码如何实现设计 | `2026-02-04_guide_信息报告-实现指南.md` |

### ✅ 整体工作流检查清单

**第 1 阶段（设计讨论）完成后**：
- [ ] 布局草稿已画出（ASCII 或文字描述）
- [ ] 交互说明已补充（表单、跳转、动画等）
- [ ] 没有提前写代码
- [ ] design 文件已记录在 `.42cog/work/` 中

**第 2 阶段（设计自我审查）完成后**：
- [ ] 已逐项检查"A～G"的所有清单项
- [ ] 对于不通过的项，已调整设计或记录原因
- [ ] 在 design 文件顶部标注"✅ 自我审查状态"
- [ ] 对于任何新的或特殊的设计约束，已在 decision 文件中说明

**第 3 阶段（设计确认）完成后**：
- [ ] 用户已明确说"可以"或"同意"
- [ ] 若有用户反馈，已调整设计并获得最终确认
- [ ] decision 文件已记录最终决策和理由

**第 4 阶段（代码实现）开始前**：
- [ ] 所有设计都已获得用户确认
- [ ] 没有遗留的"等等再改"的设计问题
- [ ] 实现方案已在脑海中清晰（或记录在 `guide` 中）
- [ ] 嵌入式图表的数据流向已确认
- [ ] 状态管理（localStorage）的字段已定义

---

## 设计审查模板

在 decision 文件中，推荐使用以下结构记录审查结果：

```markdown
## 自我审查总结

### 通过的检查项（✅）
- A1: Tab 总数 ✅ （共 4 个，≤5）
- B2: 视觉层级 ✅ （首屏第一眼是搜索框）
- C1: 排序设计 ✅ （拆分为 3 个独立选择）

### 需要调整的检查项（⚠️）
- E1: 页面职责 → 原设计混杂了"数据展示"和"行动建议"，已拆分为两个 Tab
- D3: 用户认知 → 原设计使用了"互动率"术语，已改为"用户参与度（点赞+评论÷播放量）"

### 用户无需调整的项目（ℹ️）
（如有任何设计选择不符合清单但有充分理由，在此说明）
```

---

最后更新：2026-02-04（新增第 2 阶段设计自我审查）
